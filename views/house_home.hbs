<!DOCTYPE html>
<html>
    <head>
        <title>House Points</title>
        <link rel="stylesheet" type="text/css" href="css/nav_bar.css">
        <link rel="stylesheet" type="text/css" href="css/house_points.css">
        <link href='https://fonts.googleapis.com/css?family=Dekko' rel='stylesheet'>
        <style>
            body {
             font-family: 'Dekko';font-size: 22px;
            }
        </style>
    </head>
    <body>
        {{> nav_bar }}
        
        <h1 id="titul" class="need_white">Welcome to the House Points page</h1>
        
        <div class="need_white" id="content">
             <h2 class=indicator>{{mssg}}</h2>
            {{#if loggedin}}
                <p>You can award points, {{teacher_user_name}}!</p>
                 
                 {{#if user_by_house_tn}}
                    <div class="indicator">
                        <p>The following are current students of the {{user_house_name}} house</p>
                        <table style="width:100%">
                              <tr>
                                <th>Student</th>
                              </tr>
                            {{#each users_by_house}}
                                <tr>
                                    <td>{{this}}</td>
                                    {{!--add onclick?--}}
                                </tr>
                            {{/each}}
                        </table>
                    </div>
                 {{/if}}
                 
                 {{#if points_an}}
                    <div class="indicator">
                        <p>The following is the distribution of points logged. View the get information buttons for more specific information</p>
                        <table style="width:100%">
                              <tr>
                                <th>Who awared points?</th>
                                <th>Who received points?</th>
                                <th>#Points Received</th>
                              </tr>
                            {{#each points_all}}
                                <tr>
                                    <td>{{this.giver_user}}</td>
                                    <td>{{this.receiver_user}}</td>
                                    <td>{{this.points_received}}</td>
                                    {{!--add onclick?--}}
                                </tr>
                            {{/each}}
                        </table>
                    </div>
                 {{/if}}
                
                
                <h2>Get users by house</h2>
                <form class="info">
                    Houses:<br>
                    <select name="users_by_house">
                        {{#each houses}}
                            <option value={{this}}>{{this}}</option>
                        {{/each}}
                    </select>
                    <button type="button" onclick="getUsersByHouse()">Get Users by House</button>
                </form>
                
                {{!--<p>The following are current students</p>--}}
                {{!--<table class="info" style="width:100%">--}}
                {{!--      <tr>--}}
                {{!--        <th>Student</th>--}}
                {{!--        <th>House</th>--}}
                {{!--      </tr>--}}
                {{!--    {{#each students}}--}}
                {{!--        <tr>--}}
                {{!--            <td>{{this.user}}</td>--}}
                {{!--            <td>{{this.house}}</td>--}}
                {{!--            add onclick?--}}
                {{!--        </tr>--}}
                {{!--    {{/each}}--}}
                {{!--</table>--}}
                <h2>Get points by:</h2>
                <form class="info">
                    Houses:<br>
                    <select name="house_poi">
                        {{#each houses}}
                            <option value={{this}}>{{this}}</option>
                        {{/each}}
                    </select>
                    <button type="button" onclick="getPointsByHouse()">Get Points by House</button>
                </form>
                <p id="u_poi"></p>
                <form class="info">
                    Users:<br>
                    {{!--<input id="user_poi" type="text" name="user_poi"> <br>--}}
                    <select name="user_poi">
                        {{#each students_list}}
                            <option value={{this}}>{{this}}</option>
                        {{/each}}
                    </select>
                    <button type="button" onclick="getPointsByUser()">Get Points by User</button>
                </form>
                <h2>View Points Allocation</h2>
                <div class="info">
                    <p>Click this button to view the allocation of points</p>
                    <button type="button" onclick="pointsAll()">Get Points Allocation</button>
                </div>
                
            
                <h2>Actions</h2>
                <p>Submit the following forms as teacher</p>
                <p id="message1"></p>
                <p id="message2"></p>
                <h3>Add a student to our school</h3>
                <form class="form_content">
                    Add student's name:<br>
                    <input id="user_name" type="text" name="user_name">
                    <br>
                    Add student's house:<br>
                    <select name="user_house">
                        {{#each houses}}
                            <option value={{this}}>{{this}}</option>
                        {{/each}}
                    </select>
                    <br>
                    <button type="button" onclick="addUser()">Add Student</button>
                </form>
                {{#if reset_perm}}
                    <h3>Delete a student from school</h3>
                    <form class="form_content">
                        Select the student to be deleted: <br>
                        <select name="delete_user">
                            {{#each students_list}}
                                <option value={{this}}>{{this}}</option>
                            {{/each}}
                        </select> <br>
                        <button type="button" onclick="deleteUser()">Delete Student</button>
                    </form>
                {{/if}}
                <h3>Award house points to a student!</h3>
                <form class="form_content">
                    Who's receiving points:<br>
                    <select name="receiver">
                        {{#each students_list}}
                            <option value={{this}}>{{this}}</option>
                        {{/each}}
                    </select>
                    <br>
                    How many points?(integer please):<br>
                    *Enter a negative number if you wish to take away points <br>
                    <input id="points" type="text" name="points">
                    <br>
                    <button type="button" onclick="award()">Award Points</button>
                </form>
                {{#if reset_perm}}
                    <div class="form_content">
                        <p>The following reset button will return tables to a state of no students/points</p>
                        <button type="button" onclick="reset()">Reset</button>
                    </div>
                {{/if}}
            {{else}}
                <p>Please click the following button to log in to ION for authentication in order to award points. Return to this page once logged in.</p>
                <form class="form_content">
                    <button type="button" onclick="goToProfile()">Go to Profile Page</button>
                </form>
            {{/if}}
        </div>
        <script type="text/javascript">
            function goToProfile() {
                window.location.href= 'https://user.tjhsst.edu/2021smedaram/profile_home'; 
                // take it literallly, don't double encrypt the strings
            }
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script type="text/javascript" src="client-js/house_points.js"></script>
    </body>
</html>